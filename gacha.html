<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ガチャを引く</title>
</head>

<body>
    <div id="remainingPoints">残りポイント: <span id="points">0</span>pt</div>
<button onclick="playGacha()">押せ!</button>
<video id="videoPlayer" width="320" height="240" controls style="display:none;">
    <source src="" type="video/mp4">
    お使いのブラウザは動画タグをサポートしていません。
</video>

<script>
// ポイントをローカルストレージから取得
let points = parseFloat(localStorage.getItem('points') || '0');

// ガチャを引く関数
function playGacha() {
    if (points < 10) {
        document.getElementById("result").innerText = "ポイントが不足しています。";
        return;
    }

    // 10ポイントを消費
    points -= 10;
    localStorage.setItem('points', points.toFixed(2)); // 消費後のポイントを保存

    // 確率に基づいて結果を決定
    const rand = Math.random() * 100; // 0から100の間のランダムな数値
    const resultDiv = document.getElementById("result");
    const videoPlayer = document.getElementById("videoPlayer");

    // 動画の表示設定
    videoPlayer.style.display = "block";

    if (rand < 1) {
        // スーパーラッキー (1%の確率)
        videoPlayer.src = "ex.mp4";
    } else if (rand < 20) {
        // はずれ (19%の確率)
        videoPlayer.src = "lose.mp4";
    } else {
        // あたり (80%の確率)
        videoPlayer.src = "win.mp4";
    }

    // 動画再生
    videoPlayer.load();
    videoPlayer.play();
}
</script>
</body>
</html>
